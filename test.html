<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="./node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/estilo.css">
  <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

  <title>Bootstrap Example</title>
</head>

<body>
    <main class="container d-flex justify-content-center align-items-center my-5">
        <div class="wrapper p-4 my-1 w-100 fs-4">
            <button type="button" class="btn btn-primary" onclick="filtrar()" data-bs-toggle="modal" data-bs-target="#modal">
                Modal
            </button>
        </div>
    </main>
    <div class="modal fade" id="modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">CHR026</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="content">
                    <div class="d-flex justify-content-center align-items-center">
                        <img src="http://192.168.0.111:3001/_next/image?url=%2Fapi%2FprofileImage%2FCHR026.bmp&w=128&q=100" class="card-img-top w-50 h-50" alt="...">
                    </div>
                    <div class="row mt-3">
                        <div class="col">Obra</div>
                        <div class="col">Tamanho</div>
                        <div class="col">Saldo</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

      <script>
        function filtrar() {
          var URL = `/estoque/pages/lista_estoque.php?perfil=CHR026&cor=epris`
          
          fetch(URL)
            .then(response => response.json())
            .then(data => {
              console.log(data);
              data.forEach(row => {
                if(row.saldo != 0) newRow(row)
              });
            })
            .catch(error => console.error('Erro ao buscar os perfis: ' + error));
        }
    
        function newRow(data) {
          var row = document.createElement("div");
          row.className = "row rounded mt-2 py-2";
          row.style.backgroundColor = "rgba(3, 3, 3, 0.3)";
    
          row.innerHTML = `
            <div class="col">${data.obra}</div>
            <div class="col">${data.tamanho}</div>
            <div class="col">${data.saldo}</div>
          `;
    
          var content = document.getElementById("content");
          content.appendChild(row);
        }
      </script>
</body>

</html>